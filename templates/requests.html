<!DOCTYPE html>
<html>
<head>
  <title>Team Requests | HackMate</title>
</head>
<body>

<h2>Team Requests</h2>

<div id="requestsContainer"></div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

<script src="/static/js/firebase.js"></script>
<script src="/static/js/auth.js"></script>

<!-- REQUEST LOGIC -->
<script>
async function loadRequests() {
  const user = auth.currentUser;
  if (!user) return;

  const token = await user.getIdToken();

  const res = await fetch("/api/requests", {
    headers: { "Authorization": token }
  });

  const data = await res.json();

  const container = document.getElementById("requestsContainer");
  container.innerHTML = "";

  if (data.length === 0) {
    container.innerHTML = "<p>No pending requests</p>";
    return;
  }

  data.forEach(r => {
    const div = document.createElement("div");
    div.innerHTML = `
      <p><strong>${r.name}</strong></p>
      <button onclick="respond('${r._id}', 'accepted')">Accept</button>
      <button onclick="respond('${r._id}', 'rejected')">Reject</button>
      <hr>
    `;
    container.appendChild(div);
  });
}

/* Call when page loads */
onAuthState(loadRequests);
</script>

</body>
</html>